var kirbyRatings=function(){var t={};return t.init=function(e){document.addEventListener("DOMContentLoaded",function(){t.trigger(),t.outside(),t.form(),t.submit(),t.hover(),t.url=e})},t.trigger=function(){document.querySelector(".rating-trigger").addEventListener("click",function(e){document.querySelector(".ratings-modal").classList.add("ratings-modal-show"),document.querySelector(".ratings-title").innerHTML=this.getAttribute("data-title"),document.querySelector(".ratings-fields").setAttribute("data-id",this.getAttribute("data-id")),document.querySelector(".ratings-fields").setAttribute("data-secret",t.secret())})},t.outside=function(){document.querySelector(".ratings-modal").addEventListener("click",function(t){document.querySelector(".ratings-modal").classList.remove("ratings-modal-show")})},t.form=function(){document.querySelector(".ratings-form").addEventListener("click",function(t){t.stopPropagation()})},t.secret=function(){var t=document.querySelector(".ratings-fields").getAttribute("data-id").length,e=new Date,r=e.getFullYear(),n=e.getMonth()+1,s=t*r*n;return s},t.submit=function(){document.querySelector(".ratings-submit").addEventListener("click",function(e){var r=document.querySelector(".ratings-fields").getAttribute("data-value");""!=r?t.ajax():document.querySelector(".ratings-error").classList.add("ratings-message-show")})},t.hover=function(){var t,e=document.querySelectorAll('.ratings-stars [type="radio"]');for(t=0;t<e.length;++t)e[t].addEventListener("click",function(t){document.querySelector(".ratings-fields").setAttribute("data-value",this.value),document.querySelector(".ratings-error").classList.remove("ratings-message-show")}),e[t].addEventListener("mouseover",function(t){document.querySelector(".ratings-vote-value").innerHTML=this.value,document.querySelector(".ratings-vote").classList.add("ratings-information-show")}),e[t].addEventListener("mouseout",function(t){document.querySelector(".ratings-vote").classList.remove("ratings-information-show")})},t.ajax=function(){var e=document.querySelector(".ratings-fields"),r=e.getAttribute("data-id"),n=e.getAttribute("data-secret"),s=e.getAttribute("data-value"),a=t.url+"/plugin.ratings/"+r+"?secret="+n+"&value="+s;xmlhttp=new XMLHttpRequest,xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState&&200==xmlhttp.status){var t=JSON.parse(xmlhttp.responseText);t.success?(document.querySelector(".ratings-modal").classList.remove("ratings-modal-show"),document.querySelector(".ratings-success").classList.add("ratings-message-show")):(document.querySelector(".ratings-error").innerHTML=t.message,document.querySelector(".ratings-error").classList.add("ratings-message-show"))}},xmlhttp.open("POST",a,!0),xmlhttp.send()},t}();